!function(){"use strict";function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function e(e,n){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,n){if(e){if("string"==typeof e)return t(e,n);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?t(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){a&&(e=a);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,l=!1;return{s:function(){a=a.call(e)},n:function(){var t=a.next();return c=t.done,t},e:function(t){l=!0,i=t},f:function(){try{c||null==a.return||a.return()}finally{if(l)throw i}}}}var n=function(t){var e=new URLSearchParams(window.location.search),n=e.get("sid")?e.get("sid"):"",a=-1==t.indexOf("?")?"?sid="+n:"&sid="+n;return t+a},a=function(){var t=new URLSearchParams(window.location.search);return t.get("sid")?t.get("sid"):""},o=function(t){for(var e=t+"=",n=decodeURIComponent(document.cookie).split(";"),a=0;a<n.length;a++){for(var o=n[a];" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(e))return o.substring(e.length,o.length)}return""},r=function(t){t.code,alert(t.reason)},i=function(t,n){if(document.querySelector(t)){var a,o=e(document.querySelectorAll(t));try{for(o.s();!(a=o.n()).done;){var r=a.value;r.removeEventListener("click",n,!0),r.addEventListener("click",n,!0)}}catch(t){o.e(t)}finally{o.f()}}},c=function(){var t=document.querySelector(".loader");t&&(t.style.display="block")},l={state:{firstLoad:!0,ajaxQueue:0},init:function(){l.getData()},getData:function(){l.state.firstLoad&&c(),fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:{Accept:"application/json","Content-Type":"text/plain",Authorization:"Bearer "+o("kenzap_api_key"),"Kenzap-Header":localStorage.hasOwnProperty("header"),"Kenzap-Token":o("kenzap_token"),"Kenzap-Sid":a()},body:JSON.stringify({query:{locale:{type:"locale",id:o("lang")}}})}).then((function(t){return t.json()})).then((function(t){t.success?(!function(t){t.header&&localStorage.setItem("header",t.header);var e=document.createElement("div");e.innerHTML=localStorage.getItem("header"),e=e.firstChild,document.body.prepend(e),Function(document.querySelector("#k-script").innerHTML).call("test"),window.i18n.init(t.locale)}(t),l.getLayouts(t)):r(t)})).catch((function(t){console.error("Error:",t)}))},getLayouts:function(t){fetch("https://myticket.kenzap.cloud/backend.php?cmd=get_layouts",{method:"get",headers:{Accept:"application/json","Content-type":"application/x-www-form-urlencoded",Authorization:"Bearer "+o("kenzap_api_key"),"Kenzap-Header":localStorage.hasOwnProperty("header"),"Kenzap-Token":o("kenzap_token"),"Kenzap-Sid":a()}}).then((function(t){return t.json()})).then((function(t){t.success?(l.loadHomeStructure(),l.renderPage(t),l.initListeners(),l.initFooter(),l.state.firstLoad=!1):r(t)})).catch((function(t){console.error("Error:",t)}))},renderPage:function(t){var a=document;!function(t){var n,a='<ol class="breadcrumb mt-2 mb-0">',o=e(t);try{for(o.s();!(n=o.n()).done;){var r=n.value;void 0===r.link?a+='<li class="breadcrumb-item">'.concat(r.text,"</li>"):a+='<li class="breadcrumb-item"><a href="'.concat(r.link,'">').concat(r.text,"</a></li>")}}catch(t){o.e(t)}finally{o.f()}a+="</ol>",document.querySelector(".bc").innerHTML=a}([{link:n("https://dashboard.kenzap.cloud"),text:__("Dashboard")},{text:__("MyTicket")}]);var o,r="",i=0;for(var c in t.layouts)i++,r+="\n            <tr>\n                <td>".concat(parseInt(c)+1,"</td>\n                <td>").concat(t.layouts[c].title,'</td>\n                <td style="display:none;">').concat(t.layouts[c].count_zones,'</td>\n                <td style="display:none;">').concat(t.layouts[c].count_seats,'</td>\n                <td style="text-align:right;" class="">\n                    <button class="btn btn-sm dropdown-toggle" type="button" id="dropdownMenuSizeButton').concat(c,'" data-i="').concat(c,'" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">').concat(__("Option"),'</button>\n                    <div class="dropdown-menu" aria-labelledby="dropdownMenuSizeButton').concat(c,'" >\n                        <a class="dropdown-item edit-layout" href="').concat(n("/layout-edit/?id="+t.layouts[c].id),'" target="_self" >').concat(__("Edit"),'</a>\n                        <a class="dropdown-item duplicate-layout" href="#" data-toggle="modal" data-id="').concat(t.layouts[c].id,'" >').concat(__("Duplicate"),'</a>\n                        <a class="dropdown-item rename-layout" href="#" data-toggle="modal" data-id="').concat(t.layouts[c].id,'" data-title="').concat(t.layouts[c].title,'">').concat(__("Rename"),'</a>\n                        <div class="dropdown-divider"></div>\n                        <a class="dropdown-item remove-layout" href="#" data-toggle="modal" data-id="').concat(t.layouts[c].id,'" >').concat(__("Remove"),"</a>\n                    </div>\n                </td>\n            </tr>");a.querySelector(".layout_list").innerHTML=0==i?"<tr><td>".concat(__("No layouts to display yet"),"</td><td></td><td></td><td></td><td></td></tr>"):r,(o=document.querySelector(".loader"))&&(o.style.display="none")},initListeners:function(){console.log("initListeners "),i(".rename-layout",l.listeners.renameLayout),i(".duplicate-layout",l.listeners.duplicateLayout),i(".remove-layout",l.listeners.removeLayout),l.state.firstLoad&&(i(".btn-add",l.listeners.addLayout),i(".btn-modal",l.listeners.modalSuccessBtn))},listeners:{addLayout:function(t){t.preventDefault();var e=document.querySelector(".modal"),n=new bootstrap.Modal(e);e.querySelector(".modal-title").innerHTML=__("Add Layout"),e.querySelector(".btn-primary").innerHTML=__("Add"),e.querySelector(".btn-secondary").innerHTML=__("Cancel"),t.currentTarget.dataset.id;var i='\n            <div class="form-cont">\n                <div class="form-group mb-3">\n                    <label for="p-title" class="form-label">'.concat(__("Title"),'</label>\n                    <input type="text" class="form-control" id="p-title" autocomplete="off" placeholder="').concat(__("Arena.."),'" value="').concat("",'">\n                    <ol class="mt-3 form-text">\n                        <li>Enter layout title</li>\n                        <li>Click add button</li>\n                        <li>Start creating layout</li>\n                    </ol>\n                </div>                <p class="mt-2 form-text fs-8">Need help in designing your hall or stadium? <a target="_blank" href="https://kenzap.com/seat-reservation-in-wordpress-setup-service-1014779/">View examples</a>.</p>\n            </div>');e.querySelector(".modal-body").innerHTML=i,l.listeners.modalSuccessBtnFunc=function(t){t.preventDefault();var i={};if(i.title=e.querySelector("#p-title").value,i.title.length<4)alert(__("Please provide longer title"));else{var d=new URLSearchParams;d.append("cmd","add_layout"),d.append("title",i.title),c(),fetch("https://myticket.kenzap.cloud/backend.php",{method:"post",headers:{Accept:"application/json","Content-type":"application/x-www-form-urlencoded",Authorization:"Bearer "+o("kenzap_api_key"),"Kenzap-Header":localStorage.hasOwnProperty("header"),"Kenzap-Token":o("kenzap_token"),"Kenzap-Sid":a()},body:d}).then((function(t){return t.json()})).then((function(t){t.success?(n.hide(),l.getData()):r(t)})).catch((function(t){console.error("Error:",t)}))}},n.show(),setTimeout((function(){return e.querySelector("#p-title").focus()}),100)},duplicateLayout:function(t){if(t.preventDefault(),confirm(__("Duplicate this layout?"))){var e=t.currentTarget.dataset.id;t.preventDefault();var n=new URLSearchParams;n.append("cmd","duplicate_layout"),n.append("id",e),c(),fetch("https://myticket.kenzap.cloud/backend.php",{method:"post",headers:{Accept:"application/json","Content-type":"application/x-www-form-urlencoded",Authorization:"Bearer "+o("kenzap_api_key"),"Kenzap-Header":localStorage.hasOwnProperty("header"),"Kenzap-Token":o("kenzap_token"),"Kenzap-Sid":a()},body:n}).then((function(t){return t.json()})).then((function(t){t.success?l.getData():r(t)})).catch((function(t){console.error("Error:",t)}))}},removeLayout:function(t){if(t.preventDefault(),confirm(__("Permanently remove this layout?"))){var e=t.currentTarget.dataset.id;t.preventDefault();var n=new URLSearchParams;n.append("cmd","remove_layout"),n.append("id",e),c(),fetch("https://myticket.kenzap.cloud/backend.php",{method:"post",headers:{Accept:"application/json","Content-type":"application/x-www-form-urlencoded",Authorization:"Bearer "+o("kenzap_api_key"),"Kenzap-Header":localStorage.hasOwnProperty("header"),"Kenzap-Token":o("kenzap_token"),"Kenzap-Sid":a()},body:n}).then((function(t){return t.json()})).then((function(t){t.success?l.getData():r(t)})).catch((function(t){console.error("Error:",t)}))}},renameLayout:function(t){t.preventDefault();var e=document.querySelector(".modal"),n=new bootstrap.Modal(e);e.querySelector(".modal-title").innerHTML=__("Rename Layout"),e.querySelector(".btn-primary").innerHTML=__("Rename"),e.querySelector(".btn-secondary").innerHTML=__("Cancel");var i=t.currentTarget.dataset.id,d=t.currentTarget.dataset.title,s='\n            <div class="form-cont">                <div class="form-group mb-3">                    <label for="p-title" class="form-label">'.concat(__("Title"),'</label>                    <input type="text" class="form-control" id="p-title" autocomplete="off" placeholder="" value="').concat(d,'">                </div>            </div>');e.querySelector(".modal-body").innerHTML=s,l.listeners.modalSuccessBtnFunc=function(t){t.preventDefault();var d={};if(d.title=e.querySelector("#p-title").value,d.title.length<4)alert(__("Please provide longer title"));else{var s=new URLSearchParams;s.append("cmd","rename_layout"),s.append("title",d.title),s.append("id",i),c(),fetch("https://myticket.kenzap.cloud/backend.php",{method:"post",headers:{Accept:"application/json","Content-type":"application/x-www-form-urlencoded",Authorization:"Bearer "+o("kenzap_api_key"),"Kenzap-Header":localStorage.hasOwnProperty("header"),"Kenzap-Token":o("kenzap_token"),"Kenzap-Sid":a()},body:s}).then((function(t){return t.json()})).then((function(t){t.success?(n.hide(),l.getData()):r(t)})).catch((function(t){console.error("Error:",t)}))}},n.show(),setTimeout((function(){return e.querySelector("#p-title").focus()}),100)},modalSuccessBtn:function(t){l.listeners.modalSuccessBtnFunc(t)},modalSuccessBtnFunc:null},loadHomeStructure:function(){l.state.firstLoad&&(document.querySelector("#contents").innerHTML=function(t){return'\n        <div class="container p-edit">\n            <div class="d-flex justify-content-between bd-highlight mb-3">\n                <nav class="bc" aria-label="breadcrumb"></nav>\n                <button class="btn btn-primary btn-add" type="button">'.concat(t("Add layout"),'</button>\n            </div>\n            <div class="row">\n\n                <div class="col-lg-12 grid-margin stretch-card">\n                    <div class="card border-white shadow-sm">\n                        <div class="card-body">\n                        <h4 class="card-title">').concat(t("Layout List"),'</h4>\n                        <p class="form-text">\n                            ').concat(t("Click on <code>option &gt; edit</code> to set up layout"),'\n                        </p>\n                        <div class="table-responsive">\n                            <table class="table table-hover table-borderless align-middle table-striped table-p-list" style="min-width: 800px;">\n                                <thead>\n                                    <tr>\n                                    <th>').concat(t("ID"),"</th>\n                                    <th>").concat(t("Title"),'</th>\n                                    <th style="display:none;">Zones</th>\n                                    <th style="display:none;">Seats</th>\n                                    <th style="text-align:right;"></th>\n                                    </tr>\n                                </thead>\n                                <tbody class="layout_list">\n                                    <tr>\n                                    <td></td><td></td><td></td><td></td><td></td>\n                                    </tr>\n                                </tbody>\n                            </table>\n                        </div>\n                        </div>\n                    </div>\n                </div>\n\n            </div>\n        </div>\n\n        <div class="modal" tabindex="-1">\n            <div class="modal-dialog">\n                <div class="modal-content">\n                    <div class="modal-header">\n                        <h5 class="modal-title"></h5>\n                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                    </div>\n                    <div class="modal-body">\n\n                    </div>\n                    <div class="modal-footer">\n                        <button type="button" class="btn btn-primary btn-modal"></button>\n                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"></button>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <div class="position-fixed bottom-0 p-2 m-4 end-0 align-items-center">\n            <div class="toast hide align-items-center text-white bg-dark border-0" role="alert" aria-live="assertive"\n                aria-atomic="true" data-bs-delay="3000">\n                <div class="d-flex">\n                    <div class="toast-body"></div>\n                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"\n                        aria-label="Close"></button>\n                </div>\n            </div>\n        </div>\n        \n    ')}(__))},initFooter:function(){var t,e;t=__("Copyright Â© "+(new Date).getFullYear()+' <a class="text-muted" href="https://kenzap.com/" target="_blank">Kenzap</a>. All rights reserved.'),e=__("Kenzap Cloud Services - Dashboard"),document.querySelector("footer .row").innerHTML='\n    <div class="d-sm-flex justify-content-center justify-content-sm-between">\n        <span class="text-muted text-center text-sm-left d-block d-sm-inline-block">'.concat(t,'</span>\n        <span class="float-none float-sm-right d-block mt-1 mt-sm-0 text-center text-muted">').concat(e,"</span>\n    </div>")}};l.init()}();
