{"version":3,"file":"index.js","sources":["../../src/_/_helpers.js","../../src/feed/index.js"],"sourcesContent":["/**\n * @name setCookie\n * @description Set cookie by its name to all .kenzap.com subdomains\n * @param {string} name - Cookie name.\n * @param {string} value - Cookie value.\n * @param {string} days - Number of days when cookie expires.\n */\n export const setCookie = (name, value, days) => {\n\n    let expires = \"\";\n    if (days) {\n        let date = new Date();\n        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n        expires = \";expires=\" + date.toUTCString();\n    }\n    document.cookie = name + \"=\" + (escape(value) || \"\") + expires + \";path=/\"; \n}\n\n/**\n * @name getCookie\n * @description Read cookie by its name.\n * @param {string} cname - Cookie name.\n * \n * @returns {string} value - Cookie value.\n */\nexport const getCookie = (cname) => {\n\n    let name = cname + \"=\";\n    let decodedCookie = decodeURIComponent(document.cookie);\n    let ca = decodedCookie.split(';');\n    for (let i = 0; i < ca.length; i++) {\n        let c = ca[i];\n        while (c.charAt(0) == ' ') {\n            c = c.substring(1);\n        }\n        if (c.indexOf(name) == 0) {\n            return c.substring(name.length, c.length);\n        }\n    }\n    return \"\";\n}","import { getCookie, setCookie } from \"../_/_helpers.js\"\n\nlet products = {};\nlet scroll = {state: 0, last_state: 0, state_prev: 0, fp: 0, el_id: \"\", direction: \"\", offsets: {}, timer: null};\nlet table = '';\n\nconst CDN = 'https://kenzap-sites.oss-ap-southeast-1.aliyuncs.com';\nconst appID = '66432108790002';\n\ndocument.addEventListener(\"DOMContentLoaded\", function() {\n\n    setTable();\n\n    initCart();\n\n    getMenu();\n\n    let cb = function(){ console.log('processed'); }\n    authUser(cb, false);\n\n    document.addEventListener(\"scroll\", scrollEvents);\n});\n\n/**\n * Set default table number taken from the QR-code\n * @public\n */\nconst setTable = function(){\n\n    // set current table if provided\n    let urlParams = new URLSearchParams(window.location.search);\n    table = urlParams.get('table') ? urlParams.get('table') : \"\";\n}\n\n/**\n * Show small toast notification\n * @public\n */\nconst toast = function(msg){\n\n    // Get the snackbar DIV\n    let t = document.querySelector(\".kUNwHA .snackbar\");\n    t.innerHTML = msg;\n    t.classList.add(\"show\");\n\n    // After 3 seconds, remove the show class from div\n    setTimeout(function(){ t.className = t.className.replace(\"show\", \"\"); }, 2200);\n}\n\n/**\n * initiate Cart state\n * @public\n */\nconst initCart = function(){\n\n    setBtnStep(1);\n    \n    try{\n        \n        let order = localStorage.cart;\n        \n        if(!order){ order = {created: Math.floor(Date.now() / 1000) }; }else{ order = JSON.parse(order); }\n        if(typeof(order.items) === 'undefined'){ order.items = {}; }\n\n        // check if cart expired 1h session\n        if(order.created+3600 < Math.floor(Date.now() / 1000)) {\n\n            order.items = {};\n            order.created = Math.floor(Date.now() / 1000);\n        }\n\n        cart.state.order = order;\n        // console.log(order);\n    }catch(e){\n        \n        cart.state.order.created = Math.floor(Date.now() / 1000);\n        cart.state.order.items = {};\n    }\n\n    // make sure user ID exists\n    if(!localStorage.idd) localStorage.idd = randomString(8)+Math.floor(Date.now());\n\n    // console.log(cart.state.order);\n    cart.refreshCheckoutButton();\n}\n\n/**\n * Init call to action button listeners\n * @public\n */\nconst btnListeners = function(){\n\n    // continue to table selection\n    document.querySelector(\".kUNwHA .cta-btn .mbtn\").addEventListener('click', function(e) {\n\n        document.querySelector(\"body\").classList.add('kp-modal');\n        refreshDialogView();\n\n        // view cart\n        if(cart.state.order.step == 1){\n\n            viewCheckoutModal();\n            setBtnStep(2);\n            return;\n        }\n        \n        // pick table number view\n        if(cart.state.order.step == 2){\n            \n            // view contents\n            let html = '';\n            html = '<div class=\"ptable\">';\n            html +=\t'<label for=\"table\" style=\"'+(table.length>0?'display:none;':'')+'\">Table number</label>';\n            html +=\t'<input type=\"number\" value=\"'+table+'\" name=\"table\" style=\"'+(table.length>0?'display:none;':'')+'\" autocomplete=\"off\" class=\"table\" size=\"4\" pattern=\"\" inputmode=\"\">';\n            html +=\t'<label for=\"note\">Note</label>';\n            html += '<textarea class=\"note\" name=\"note\" placeholder=\"leave a note for a kitchen\"></textarea>';\n            html +=\t'</div>';\n\n            document.querySelector(\".kUNwHA .cdialog-cnt .kp-body\").innerHTML = html;\n            document.querySelector(\".kUNwHA .cdialog-cnt .ptable .table\").focus();\n\n            setBtnStep(3);\n            return;\n        }\n\n        // finalize checkout\n        if(cart.state.order.step == 3){\n\n            // validate input field\n            let table = document.querySelector(\".kUNwHA .cdialog-cnt .ptable .table\").value;\n            let note = document.querySelector(\".kUNwHA .cdialog-cnt .ptable .note\").value;\n            if(table==\"\"){ alert(\"Please enter table number\"); return; }\n\n            // get note\n            cart.state.order.table = table;\n            cart.state.order.note = note;\n\n            // cache data\n            localStorage.cart = JSON.stringify(cart.state.order);\n\n            // close checkout modal\n            let mdialogCnt = document.querySelector(\".kUNwHA .cdialog-cnt\");\n            mdialogCnt.style.display = \"none\";\n\n            // hide button\n            document.querySelector(\".kUNwHA .cta-btn\").style.display = \"none\";\n\n            // restore body scrolling params \n            closeModal();\n            \n            // send order to backend\n            // let cb = function(){ console.log('processed'); }\n            // authUser(cb, true);\n \n            // auth user to finish checkout\n            let origin = config.domain;\n            if(origin.indexOf('checkout')==-1) origin += (origin.indexOf('?')==-1 ? '?':'&')+'checkout=1';\n            // alert('https://auth.kenzap.com/?app='+appID+'&redirect='+encodeURIComponent(origin));\n            window.location.href = 'https://auth.kenzap.com/?app='+appID+'&redirect='+encodeURIComponent(origin);\n            \n            document.querySelector(\".kUNwHA .overlay\").style.display = \"block\";\n            document.querySelector(\".kUNwHA .overlay .loader\").style.display = \"block\";\n\n            return;\n        }\n\n        // offer sign in\n        if(cart.state.order.step == 4){\n\n            // restore body scrolling params\n            closeModal();\n\n            // window.location.href = 'https://auth.kenzap.com/?redirect=https%3A%2F%2Faccount.kenzap.com%2F%3Flauncher%3Dmenu-orders&idd=' + localStorage.idd;\n            return;\n        }\n    });\n}\n\n/**\n * set button Call to action step\n * @public\n */\nconst setBtnStep = function(step){\n\n    document.querySelector(\".kUNwHA .cta-btn\").style.display = \"block\";\n    switch(step){\n\n        case 1: cart.state.order.step = step; document.querySelector(\".kUNwHA .cta-btn .mbtn\").innerHTML = 'View basket <span class=\"price\">s$0.00</span>'; break;\n        case 2: cart.state.order.step = step; document.querySelector(\".kUNwHA .cta-btn .mbtn\").innerHTML = 'Continue'; break;\n        case 3: cart.state.order.step = step; document.querySelector(\".kUNwHA .cta-btn .mbtn\").innerHTML = 'Checkout';  break;\n        case 4: cart.state.order.step = step; document.querySelector(\".kUNwHA .cta-btn .mbtn\").innerHTML = \"Back to menu\"; break;\n    }\n}\n\n/**\n * Gets menu data\n * @public\n */\nconst getMenu = function(){\n\n    const limit = 1000;\n\n    // let page = getPage(); \n    let offset = 0;\n    \n    fetch('https://api-v1.kenzap.cloud/', {\n        method: 'post',\n        headers: {\n            'Accept': 'application/json',\n            'Content-Type': 'text/plain',\n            'Authorization': 'Bearer ' + API_KEY,\n\n        },\n        body: JSON.stringify({\n            query: {\n                /* user: {\n                    type:       'authenticate',\n                    fields:     ['avatar'],\n                    token:      getCookie('kenzap_token')\n                },\n                locale: {\n                    type:       'locale',\n                    id:         getCookie('lang')\n                },\n                */\n                items: {\n                    type:       'find',\n                    key:        'ecommerce-product',\n                    // sid:        sid,\n                    fields:     ['_id', 'id', 'img', 'status', 'price', 'priced', 'title', 'cats', 'sdesc', 'ldesc', 'variations', 'updated'],\n                    limit:      limit,\n                    offset:     offset,\n                    sortby:     {\n                                    field: 'created',\n                                    order: 'ASC'\n                                }\n                },\n                settings: {\n                    type:       'get',\n                    key:        'qrmenu-settings',\n                    fields:     ['mode', 'palette', 'categories'],\n                }\n            }\n        })\n    })\n    .then(response => response.json())\n    .then(response => {\n\n        if (response.success){\n\n            products = response;\n\n            localStorage.sid = response.sid;\n\n            renderMenu();\n\n            dialogListeners();\n\n            menuListeners();\n\n            sliderListeners();\n\n            btnListeners();\n            \n            console.log(response);\n        \n        }else{\n\n            // parseApiError(response);\n        }\n    })\n    .catch(error => {\n        console.error('Error:', error);\n    });\n}\n\n/**\n * Render menu dialog\n * @public\n */\nconst renderMenu = function(){\n\n    let rows = products.settings.categories.split('\\n');\n    let html_slider = '';\n    let html_menu = '';\n    let title = '';\n\n    for(let c of rows){\n\n        \n        // get values\n        let val = c.split('|');\n        let cat = val[0].trim();\n        let note = val[1] == null ? '' : val[1].trim();\n        console.log(note);\n\n        // render slider\n        html_slider += '<div class=\"slide\" data-href=\"'+convertToSlug(cat)+'\"><a href=\"#'+convertToSlug(cat)+'\" class=\" cl\">'+cat+'</a></div>'; \n\n        // render menu\n        for(let x in products['items']){\n\n            // centralize IDS\n            products['items'][x].id = products['items'][x]._id;\n\n            // skip current loop if current category not present\n            if(typeof(products['items'][x]['cats']) === 'undefined') continue;\n            if(products['items'][x]['cats'] == null) continue;\n            if(!products['items'][x]['cats'].includes(cat)) continue;\n\n            // product image\n            let img = 'https://cdn.kenzap.com/loading.png';\n\n            // load image asyncronously\n            if(products['items'][x]['img'][0] || products['items'][x]['img'][0] == 'true'){\n\n                let imgl = new Image();\n                imgl._id = products['items'][x]['_id'];\n                imgl.onload = function () { console.log('adding'+this.src); document.querySelector(\".kUNwHA .kenzap-row[data-id='\"+this._id+\"'] img\").setAttribute('src', this.src); }\n                imgl.src = CDN + '/S'+localStorage.sid+'/product-'+products['items'][x]['_id']+'-1-250.jpeg?'+products['items'][x]['updated'];\n            }\n\n            // price\n            let price = '<span class=\"tag ptag\">'+priceFormat(products['items'][x]['price'])+'</span>';\n            if(products['items'][x]['priced']!=''){\n\n                price = '<span class=\"ptagc\">'+priceFormat(products['items'][x]['price'])+'</span> <span class=\"tag ptag\">'+priceFormat(products['items'][x]['priced'])+'</span>';\n            }\n\n            let ctag = typeof(cart.state.order.items[products['items'][x]['_id']]) === 'undefined' ? \"\" : cart.state.order.items[products['items'][x]['_id']].qty;\n            let show_heading = '';\n            if(title != cat){ title = cat; show_heading = '<h2 id=\"'+convertToSlug(title)+'\">'+title+'</h2><p class=\"subnote\">'+note+'</p>'; }\n            html_menu += '\\\n            <div class=\"kenzap-row\" data-index=\"'+x+'\" data-id=\"'+products['items'][x]['_id']+'\">\\\n                '+show_heading+'\\\n                <div class=\"info-box\">\\\n                    <div class=\"kenzap-col-7\">\\\n                        <div class=\"kp-content\">\\\n                            <h3><span class=\"tag ctag\">'+ctag+'</span>'+products['items'][x]['title']+'</h3>\\\n                            <p>'+products['items'][x]['sdesc']+'</p>\\\n                            '+price+'\\\n                        </div>\\\n                    </div>\\\n                    <div class=\"kenzap-col-5\">\\\n                        <div class=\"kp-img\">\\\n                            <img src=\"'+img+'\" alt=\"'+products['items'][x]['title']+'\">\\\n                        </div>\\\n                    </div>\\\n                </div>\\\n                \\\n            </div>';\n        }\n    }\n\n    let slider_container = document.querySelector(\".kUNwHA .slideset\");\n    let menu_container = document.querySelector(\".kUNwHA .kenzap-container\");\n    if(html_menu==''){\n        menu_container.innerHTML = \"Please add products and specify categories first\";\n    }else{\n        slider_container.innerHTML = html_slider;\n        menu_container.innerHTML = html_menu;\n    }\t\n}\n\n/**\n * Dialog box listeners\n * @public\n */\nconst dialogListeners = function(){\n\n    let close = document.querySelector(\".kUNwHA .mdialog .close\");\n    close.addEventListener('click', function(e) {\n\n        closeModal();\n    });\n\n    let close2 = document.querySelector(\".kUNwHA .cdialog .close\");\n    close2.addEventListener('click', function(e) {\n\n        let cdialogCnt = document.querySelector(\".kUNwHA .cdialog-cnt\");\n        cdialogCnt.style.display = \"none\";\n\n        setBtnStep(1);\n\n        closeModal();\n    });\n\n    window.addEventListener(\"resize\", refreshDialogView);\n    window.addEventListener(\"orientationchange\", refreshDialogView);\n}\n\n/**\n * Close product popup\n * @public\n */\nconst closeModal = function(){\n\n    let mdialogCnt = document.querySelector(\".kUNwHA .mdialog-cnt\");\n    mdialogCnt.style.display = \"none\";\n\n    document.querySelector(\".kUNwHA .overlay\").style.display = \"none\";\n\n    // allow body scroll\n    document.querySelector(\".kUNwHA .scrollable\").style.height = 'auto';\n    document.querySelector(\".kUNwHA .scrollable\").style.overflowY = 'scroll';\n\n    document.querySelector(\"body\").style.overflowY = 'auto';\n    document.querySelector(\"body\").style.height = 'auto';\n    setTimeout(function(){ document.querySelector(\"body\").classList.remove('kp-modal'); },300);\n\n    document.documentElement.scrollTop = scroll.last_state;\n\n    let cdialogCnt = document.querySelector(\".kUNwHA .cdialog-cnt\");\n    cdialogCnt.style.display = \"none\";\n\n    cart.refreshCheckoutButton();\n}\n\n/**\n * Dialog box listeners\n * @public\n */\nconst refreshDialogView = function(){\n\n    // body prevent scroll\n    if(document.querySelector(\"body\").classList.contains('kp-modal')){\n        document.querySelector(\"body\").style.height = '100vh';\n        document.querySelector(\"body\").style.overflowY = 'hidden';\n        document.querySelector(\".kUNwHA .scrollable\").style.height = '100vh';\n        document.querySelector(\".kUNwHA .scrollable\").style.overflowY = 'hidden';\n        document.querySelector(\".kUNwHA .mdialog-cnt\").style.height = (window.screen.availHeight-160) + \"px\";\n    }\n    // document.querySelector(\".kUNwHA .cdialog-cnt\").style.height = (window.screen.availHeight-160) + \"px\";\n}\n\n/**\n    * Menu horizontal slider listeners listener.\n    * @public\n    */\nconst menuListeners = function(){\n\n    // menu row click listener\n    let row_list = document.querySelectorAll(\".kUNwHA .kenzap-row\");\n    for(const row of row_list){\n\n        row.addEventListener('click', function(e) {\n\n            let x = this.dataset.index; cart.state.index = x;\n            let product_id = products['items'][x].id;\n            let mdialogCnt = document.querySelector(\".kUNwHA .mdialog-cnt\");\n            scroll.last_state = scroll.state;\n\n            // console.log(cart.state.order.items);\n\n            cart.state.total = 0;\n            cart.state.count = 0;\n\n            // update cart state\n            cart.state.product = typeof(cart.state.order.items[product_id]) === 'undefined' ? {id: products['items'][x].id, title: products['items'][x].title, sdesc: products['items'][x].sdesc, index: x, qty: 0, note: \"\", variations:[] }:cart.state.order.items[product_id];\n            \n            // detect product state\n            cart.state.product.type = cart.state.product.qty == 0 ? \"new\" : \"update\";\n            \n            document.querySelector(\"body\").classList.add('kp-modal');\n            // console.log(cart.state.product.variations);\n\n            refreshDialogView();\n\n            let src = (products['items'][x]['img'][0]) ? CDN + '/S'+localStorage.sid+'/product-'+products['items'][x]['_id']+'-1-250.jpeg?'+products['items'][x]['updated'] : 'https://cdn.kenzap.com/loading.png'\n\n\n            // bind data to modal body\n            document.querySelector(\".kUNwHA .mdialog-cnt .mdialog .kp-body > h2\").innerHTML = cart.state.product.title;\n            document.querySelector(\".kUNwHA .mdialog-cnt .mdialog .kp-body > p\").innerHTML = cart.state.product.sdesc;\n            document.querySelector(\".kUNwHA .mdialog-cnt .mdialog .kp-img img\").setAttribute('src', src);\n            document.querySelector(\".kUNwHA .mdialog .qty\").value = cart.state.count = cart.state.product.qty;\t\n            document.querySelector(\".kUNwHA .mdialog .kp-note textarea\").value = cart.state.product.note;\t \n\n            // load image asyncronously\n            var imgl = new Image();\n            imgl.onload = function () { document.querySelector(\".kUNwHA .mdialog-cnt .mdialog .kp-img img\").setAttribute('src', this.src); }\n            imgl.src = CDN + '/S'+localStorage.sid+'/product-'+products['items'][x]['_id']+'-1-500.jpeg?'+products['items'][x]['updated'];\n\n            // \"variations\":[{\"title\":\"Sauce\",\"type\":\"checkbox\",\"required\":\"0\",\"data\":[{\"title\":\"Chilli\",\"price\":\"0.40\",\"cond\":\"\"},{\"title\":\"Teriyaki\",\"price\":\"1.00\",\"cond\":\"\"}]},{\"title\":\"Rice\",\"type\":\"checkbox\",\"required\":\"1\",\"data\":[{\"title\":\"rice\",\"price\":\"0.00\",\"cond\":\"\"},{\"title\":\"cdscdsc\",\"price\":\"0.00\",\"cond\":\"\"}]}]}\n            let html_vars = '';\n            if(typeof(products['items'][x].variations !== 'undefined'))\n            for(let v in products['items'][x].variations){\n\n                // products['items'][x].variations[v].title\n\n                // variation type\n                let type = '';\t\n                if(products['items'][x].variations[v].type=='checkbox') type = 'check';\n                if(products['items'][x].variations[v].type=='radio') \ttype = 'radio';\n\n                // update cart state\n                if(typeof(cart.state.product.variations[v]) === 'undefined') cart.state.product.variations[v] = {title: products['items'][x].variations[v].title, required: products['items'][x].variations[v].required, allow: products['items'][x].variations[v].required == '1'?false:true };\t\n\n                // struct variation\n                html_vars += '\\\n                <h3>'+products['items'][x].variations[v].title+(products['items'][x].variations[v].required == '1' ? ' <span class=\"tag\">required</span>':'')+'</h3>\\\n                <div class=\"kp-'+type+'\">';\n\n                // variation labels\n                for(let d in products['items'][x].variations[v].data){\n\n                    let checked = false;\n                    // console.log(cart.state.product.variations);\n                    if(typeof(cart.state.product.variations[v]) !== 'undefined' && typeof(cart.state.product.variations[v].list) !== 'undefined' && typeof(cart.state.product.variations[v].list[\"_\"+d]) !== 'undefined'){\n\n                        checked = true;\n                        // alert(\"checked\");\n                        // checked = typeof(cart.state.product.variations[v].list[\"_\"+d]) === 'undefined' ? false : true;\n                    }\n                    \n                    switch(type){\n                        case 'check':\n\n                        html_vars += '\\\n                            <label>\\\n                                <input type=\"checkbox\" data-required=\"'+products['items'][x].variations[v].required+'\" data-indexv=\"'+v+'\" data-index=\"'+d+'\" data-title=\"'+products['items'][x].variations[v].data[d]['title']+'\" data-price=\"'+products['items'][x].variations[v].data[d]['price']+'\" '+(checked?'checked=\"checked\"':'')+'>\\\n                                <div class=\"checkbox\">\\\n                                    <svg width=\"20px\" height=\"20px\" viewBox=\"0 0 20 20\">\\\n                                        <path d=\"M3,1 L17,1 L17,1 C18.1045695,1 19,1.8954305 19,3 L19,17 L19,17 C19,18.1045695 18.1045695,19 17,19 L3,19 L3,19 C1.8954305,19 1,18.1045695 1,17 L1,3 L1,3 C1,1.8954305 1.8954305,1 3,1 Z\"></path>\\\n                                        <polyline points=\"4 11 8 15 16 6\"></polyline>\\\n                                    </svg>\\\n                                </div>\\\n                                <span>'+products['items'][x].variations[v].data[d]['title']+'</span>\\\n                                <div class=\"price\">+ '+priceFormat(products['items'][x].variations[v].data[d]['price'])+'</div>\\\n                            </label>';\n                        \n                        break;\n                        case 'radio':\n\n                        html_vars += '\\\n                            <label>\\\n                                <input type=\"radio\" data-required=\"'+products['items'][x].variations[v].required+'\" data-indexv=\"'+v+'\" name=\"radio\" data-index=\"'+d+'\" data-title=\"'+products['items'][x].variations[v].data[d]['title']+'\" data-price=\"'+products['items'][x].variations[v].data[d]['price']+'\" '+(checked?'checked=\"checked\"':'')+' />\\\n                                <span>'+products['items'][x].variations[v].data[d]['title']+'</span>\\\n                                <div class=\"price\">+ '+priceFormat(products['items'][x].variations[v].data[d]['price'])+'</div>\\\n                            </label>';\n                        \n                        break;\n                    }\n                }\n\n                html_vars += '</div>';\n\n                // html_var = '\\\n                // <h3>'+products['items'][x].variations[v].title+' '+(products['items'][x].variations[v].required == '1' ? '<span class=\"tag\">required</span>':'')+'</h3>\\\n                // <div class=\"kp-'+type+'\">\\\n                // \t'+labels+'\\\n                // </div>';\n            }\n\n            document.querySelector(\".kUNwHA .mdialog-cnt .mdialog .kp-vars\").innerHTML = html_vars;\n\n            cart.refreshButton();\n            \n            mdialogCnt.style.display = \"block\";\n            document.querySelector(\".kUNwHA .overlay\").style.display = \"block\";\n    \n            // checkbox listener\n            let checkbox_list = document.querySelectorAll(\".kUNwHA .mdialog .kp-check input[type=checkbox]\");\n            for(const cb of checkbox_list){\n                cb.addEventListener('change', function() {\n\n                    console.log(\"call refreshButton\");\n\n                    let v = parseInt(cb.dataset.indexv);\n                    // if(typeof(cart.state.product.variations[v].list) === 'undefined') \n                    cart.state.product.variations[v].list = {};\n\n                    let count = 0;\n                    for(const cbg of document.querySelectorAll(\".kUNwHA .mdialog .kp-check input[type=checkbox][data-indexv='\"+v+\"']\")){\n\n                        // checks if this block is required and allows checkout\n                        if(cb.dataset.required==\"1\"){ if(count) cart.state.product.variations[v].allow = true; }else{ cart.state.product.variations[v].allow = true; }\n\n                        // cache selected variations\n                        if(cbg.checked){ cart.state.product.variations[v].list[\"_\"+cbg.dataset.index] = {title: cbg.dataset.title, price: parseFloat(cbg.dataset.price) }; count +=1; }\n                    }\n                    \n                    // console.log(cart.state.product.variations);\n                    cart.refreshButton();\n                });\n            }\n\n            // radio listener\n            let radio_list = document.querySelectorAll(\".kUNwHA .mdialog .kp-radio input[type=radio]\");\n            for(const cb of radio_list){\n                cb.addEventListener('change', function() {\n\n                    console.log(\"call refreshButton\");\n\n                    let v = parseInt(cb.dataset.indexv);\n                    // if(typeof(cart.state.product.variations[v].list) === 'undefined') \n                    cart.state.product.variations[v].list = {};\n\n                    let count = 0;\n                    for(const rag of document.querySelectorAll(\".kUNwHA .mdialog .kp-radio input[type=radio][data-indexv='\"+v+\"']\")){\n                    \n                        // cache selected variations\n                        if(rag.checked){ cart.state.product.variations[v].list[\"_\"+rag.dataset.index] = {title: rag.dataset.title, price: parseFloat(rag.dataset.price) }; count +=1; }\n                        \n                        // checks if this block is required and allows checkout\n                        if(cb.dataset.required==\"1\"){ if(count) cart.state.product.variations[v].allow = true; }else{ cart.state.product.variations[v].allow = true; }\n                    }\n\n                    // console.log(cart.state.product.variations);\n\n                    cart.refreshButton();\n                });\n            }\n        });\n        // cart.refreshButton();\n        // console.log(cart.state.product);\n    }\n\n    // plus click listener\n    let qty = document.querySelector(\".kUNwHA .mdialog .qty\");\n    let plus = document.querySelector(\".kUNwHA .mdialog .plus\");\n    plus.addEventListener('click', function(e) {\n\n        if(cart.state.count < config.cart.max_addition) cart.state.count +=1;\n        qty.value = cart.state.count;\n        cart.refreshButton();\n        vibrate();\n    });\n    \n    // minus click listener\n    let minus = document.querySelector(\".kUNwHA .mdialog .minus\");\n    minus.addEventListener('click', function(e) {\n\n        if(cart.state.count > 0) cart.state.count -=1;\n        qty.value = cart.state.count;\n        cart.refreshButton();\n        vibrate();\n    });\n\n    // add to cart listener\n    let add = document.querySelector(\".kUNwHA .mdialog .add\");\n    add.addEventListener('click', function(e) {\n\n        if(this.parentNode.classList.contains(\"dis\")){ alert(\"Please select required fields\"); return; }\n        cart.addToCart();\n        // cart.resetButton(); \n        closeModal();\n        toast(\"Cart updated\");\n        vibrate();\n    });\n\n    // checkout  button listener\n    // let checkout = document.querySelector(\".kUNwHA .vadd\");\n    // checkout.addEventListener('click', function(e) {\n\n    // \tviewCheckoutModal();\n    // });\n}\n\n/**\n    * view checkout modal\n    * @public\n    */\nconst viewCheckoutModal = function(){\n\n    let cdialogCnt = document.querySelector(\".kUNwHA .cdialog-cnt\");\n\n    refreshDialogView();\n\n    cdialogCnt.style.display = \"block\";\n    document.querySelector(\".kUNwHA .overlay\").style.display = \"block\";\n\n    // generate cart table\n    let html = '<table>';\n    let total = 0;\n    for(let p in cart.state.order.items){\n\n        // console.log(cart.state.order.items[p].priceF);\n        total += parseFloat(cart.state.order.items[p].priceF);\n        html += '<tr><td data-id=\"'+cart.state.order.items[p].id+'\" class=\"checkt\">'+cart.state.order.items[p].qty+' x '+cart.state.order.items[p].title+'</td><td></td><td class=\"price\"><strong>'+priceFormat(cart.state.order.items[p].price)+'</strong></td></tr>';\n    }\n\n    html += '<tr><td class=\"summ\" colspan=\"3\">Total <strong>'+priceFormat(total)+'</strong></td></tr>';\n    html += '</table>';\n\n    cdialogCnt.querySelector(\".kUNwHA .cdialog-cnt .kp-body\").innerHTML = html;\n\n    // remove item from cart\n    for(const td of cdialogCnt.querySelectorAll(\".kUNwHA .cdialog-cnt .kp-body .checkt\")){\n\n        td.addEventListener('click', function(e) {\n\n            let c = confirm(\"Remove \"+this.innerHTML + \"?\");\n            if(c){\n\n                document.querySelector(\".kUNwHA .kenzap-row[data-id='\"+this.dataset.id+\"'] .ctag\").innerHTML = \"\";\n                cart.removeFromCart(this.dataset.id);\n                cart.refreshCheckoutButton();\n\n                // console.log(cart.state.order.items);\n                if(Object.keys(cart.state.order.items).length == 0){\n\n                    setBtnStep(1);\n                    // console.log(\"closeModal\"); \n                    closeModal(); \n                    return; \n                }\n                viewCheckoutModal();\n                setBtnStep(2);\n            }\n        });\n    }\t\n}\n\n/**\n    * view thank you modal\n    * @public\n    */\nconst viewThankyouModal = function(){\n\n    let tdialogCnt = document.querySelector(\".kUNwHA .cdialog-cnt\");\n\n    refreshDialogView();\n\n    tdialogCnt.style.display = \"block\";\n    document.querySelector(\".kUNwHA .overlay\").style.display = \"block\";\n\n    // generate cart table\n    let html = '<div>';\n    html += '<h3>Order received!</h3>';\n    html += '<p>Thank you for your order, you can close the window or return to the menu.</p>';\n    html += '<lottie-player src=\"https://assets8.lottiefiles.com/packages/lf20_fefIZO.json\"  background=\"transparent\"  speed=\"1\" class=\"lplayer\" style=\"width: 300px; height: 300px;\" loop  autoplay></lottie-player>';\n    \n    // generate order table\n    html += '<h4>Summary</h4>';\n    html += '<table>';\n    let total = 0;\n    let lastOrder = JSON.parse(localStorage.lastOrder);\n    for(let p in lastOrder.items){\n\n        // console.log(cart.state.order.items[p].priceF);\n        total += parseFloat(lastOrder.items[p].priceF);\n        html += '<tr><td data-id=\"'+lastOrder.items[p].id+'\" class=\"checkt\">'+lastOrder.items[p].qty+' x '+lastOrder.items[p].title+'</td><td></td><td class=\"price\"><strong>'+priceFormat(lastOrder.items[p].price)+'</strong></td></tr>';\n    }\n\n    html += '<tr><td class=\"summ\" colspan=\"3\">Total <strong>'+priceFormat(total)+'</strong></td></tr>';\n    html += '</table>';\n\n    \n    // html +=  \n    html += '</div>';\n\n    tdialogCnt.querySelector(\".kUNwHA .cdialog-cnt .kp-body\").innerHTML = html;\n}\n\n/**\n    * send checkout data to backend\n    * @public\n    */\nconst authUser = function(cb, force){\n        \n    let urlParams = new URLSearchParams(window.location.search);\n    let ott = urlParams.get('ott') ? urlParams.get('ott') : \"\";\n    \n    let params = new URLSearchParams();\n        params.append(\"cmd\", \"get_state\");\n        params.append(\"app\", appID);\n        params.append(\"ott\", ott);\n        params.append(\"token\", getCookie('kenzap_token'));\n\n    // do API query\n    fetch('https://api-v1.kenzap.cloud/auth/', {\n        method: 'post',\n        headers: {\n            'Accept': 'application/json',\n            'Content-type': 'application/x-www-form-urlencoded',\n            // 'Authorization': 'Bearer ' + getCookie('kenzap_api_key'),\n        },\n        body: params\n    })\n    .then(response => response.json())\n    .then(response => {\n \n        alert(JSON.stringify(response));\n  \n        let checkout = urlParams.get('checkout') ? urlParams.get('checkout') : \"\";\n        if(!checkout) return;\n\n        if(response.success){\n\n            if(response.token){ config.token = response.token; setCookie('kenzap_token', response.token, 1); console.log('setting up token'); }\n\n            // let table = 5;\n            cart.state.order.kid = response.kid;\n            cart.state.order.name = response.name;\n            cart.state.order.from = table+' - '+response.name;\n            cart.state.order.status = 'new';\n\n            // DO CHECKOUT\n            // cb.call();\n            ajaxCheckout();\n        }else{\n\n            alert('Oops, something went wrong. Please try checking out again.');\n \n            // DO AUTH\n            // if(force) window.location.href = 'https://auth.kenzap.com/?app='+appID+'&redirect='+encodeURI(window.location.href);\n            // window.location.href = 'https://auth.kenzap.com/?app='+appID;\n            // https://auth.kenzap.com/?app=66432108790001\n        }\n    })\n    .catch(error => {\n        console.error('Error:', error);\n    });\n}\n\n/**\n    * send checkout data to backend\n    * @public\n    */\nconst ajaxCheckout = function(){\n\n    cart.state.order.idd = localStorage.idd;\n    cart.state.order.sid = localStorage.sid;\n    cart.state.order.id = (typeof(cart.state.order.id) === 'undefined' ? randomString(8)+Math.floor(Date.now()) : cart.state.order.id);\n\n    localStorage.lastOrder = JSON.stringify(cart.state.order);\n\n    // alert(cart.state.order.id);\n    let kenzap_api_key = 'DoSTdhxk6BTIHiYno9XhZ4zorh0ak0MRGMH5T2iP2h1BNo3MtA69irZJp3pZuaiA';\n\n    // do API query\n    fetch('https://api-v1.kenzap.cloud/', {\n        method: 'post',\n        headers: {\n            'Accept': 'application/json',\n            'Content-type': 'application/x-www-form-urlencoded',\n            // 'Authorization': 'Bearer ' + kenzap_api_key,\n            'Kenzap-Token': config.token,\n            'Kenzap-Sid': localStorage.sid,\n        },\n        body: JSON.stringify({\n            query: {\n                order: {\n                    type:       'create',\n                    key:        'ecommerce-order',        \n                    sid:        localStorage.sid,\n                    data:       cart.state.order\n                }\n            }\n        })\n    })\n    .then(response => response.json())\n    .then(response => {\n\n        if(response.success){\n\n            viewThankyouModal();\n\n            // reset cart\n            cart.clearCart();\n\n            // next step\n            setBtnStep(4);\n        }else{\n\n           //  alert(\"Error occured. Please try again!\");\n            alert('error'+JSON.stringify(response));\n\n        }\n    })\n    .catch(error => {\n        console.error('Error:', error);\n    });\n}\n\n/**\n    * trigger small vibration effect when user interacts with UI\n    * @public\n    */\n    const vibrate = function(){\n\n    if (window.navigator && window.navigator.vibrate) {\n        // Vibrate once for 1 second\n        navigator.vibrate(20);\n    }\n}\n\n/**\n    * Menu horizontal slider listeners.\n    * @public\n    */\nconst sliderListeners = function(){\n\n    let slide_list = document.querySelectorAll(\".kUNwHA .slideset .slide\");\n    for(const slide of slide_list){\n\n        // offsetLeft\n        let scrollDiv = slide.offsetLeft;\n        scroll.offsets[slide.dataset.href] = scrollDiv;\n        slide.addEventListener('click', function(e) {\n\n            let sto = document.documentElement.scrollTop;\n            // document.documentElement.scrollTop = sto-=10;\n            setTimeout(function(el){\n\n                for (const l of document.querySelectorAll(\".kUNwHA .slide\")){ l.classList.remove(\"active\"); }\n                el.classList.add(\"active\");\n                // document.documentElement.scrollTop = sto+=10;\n            },250, this)\n        });\n    }\n}\n\n/**\n    * Scroll listener. Add/Remove scrolled class to body\n    * @public\n    */\n    const scrollEvents = function() {\n\n    // console.log(document.documentElement.scrollTop);\n    let h_list = document.querySelectorAll(\".kUNwHA .kenzap-row h2\");\n    let s_id = \"\";\n    let diff_prev = 0;\n    let diff = 0;\n    scroll.state = document.documentElement.scrollTop;\n\n    for (const h of h_list){\n\n        diff = (h.offsetTop - document.documentElement.scrollTop);\n        \n        // scrolling up\n        // if(scroll.state<scroll.state_prev){\n\n        // \tscroll.direction = \"up\";\n        // \tif(diff>0){\n                \n        // \t\tif(scroll.el_id == \"\") scroll.el_id = h.id;\n        // \t\tif(diff_prev > diff){ console.log(diff + \" \" +h.id); diff = diff_prev; scroll.el_id = h.id; }\n        // \t}\n        // }\n\n        // scrolling down\n        // if(scroll.state>scroll.state_prev){\n\n            scroll.direction = \"down\";\n            if(diff<0){\n\n                if(diff_prev > diff){ diff = diff_prev; scroll.el_id = h.id; }\n            }\n    \n            // if(diff>0){\n\n            // }\n        // }\n\n        diff_prev = diff;\n    }\n\n    // save previous scroll state\n    if(scroll.state_prev!=scroll.state) scroll.state_prev = scroll.state;\n\n    if(scroll.el_id!=\"\"){\n\n        let sc = document.querySelector(\".kUNwHA .cata-sub-nav\");\n        if(scroll.timer) clearTimeout(scroll.timer);\n        scroll.timer = setTimeout((el_id) => {\n\n            sc.scrollTo({ left: scroll.offsets[el_id], behavior: 'smooth'});\n\n            for (const l of document.querySelectorAll(\".kUNwHA .slide\")){ l.classList.remove(\"active\"); }\n            document.querySelector(\".kUNwHA [data-href='\"+el_id+\"']\").classList.add(\"active\");\n\n        }, 200, scroll.el_id);\n    }\n\n    scroll.el_id = \"\";\n}\n\n/**\n    * Convert text to url friendly slug \n    * @public\n    */\nconst convertToSlug = function(str) {\n\n    return str\n        .toLowerCase()\n        .replace(/[^\\w ]+/g,'')\n        .replace(/ +/g,'-')\n        ;\n}\n\n/**\n    * Render price\n    * @public\n    */\nconst priceFormat = function(price) {\n\n    let priceF = parseFloat(price).toFixed(2);\n\n    switch(config.price.style){\n        case 'left': priceF = config.price.symbol + priceF; break;\n        case 'right': priceF = priceF + config.price.symbol; break;\n    }\n\n    return priceF;\n}\n\n/**\n    * Generates a random string\n    * \n    * @param int length_\n    * @return string\n    */\nconst randomString = function(length_) {\n\n    var chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghiklmnopqrstuvwxyz'.split('');\n    if (typeof length_ !== \"number\") {\n        length_ = Math.floor(Math.random() * chars.length_);\n    }\n    var str = '';\n    for (var i = 0; i < length_; i++) {\n        str += chars[Math.floor(Math.random() * chars.length)];\n    }\n    return str;\n}\n\n/**\n    * Get cookie by name\n    * @param cname cookie name\n    * @public\n    */\n// const getCookie = (cname) => {\n\n//     let name = cname + \"=\";\n//     let decodedCookie = decodeURIComponent(document.cookie);\n//     let ca = decodedCookie.split(';');\n//     for (let i = 0; i < ca.length; i++) {\n//         let c = ca[i];\n//         while (c.charAt(0) == ' ') {\n//             c = c.substring(1);\n//         }\n//         if (c.indexOf(name) == 0) {\n//             return c.substring(name.length, c.length);\n//         }\n//     }\n//     return \"\";\n// }\n\n/**\n    * Cart and checkout functions\n    * @public\n    */\nlet cart = {\n\n    state: {total: 0, count: 0, index: 0, product: { variations: [] }, order: {} },\n    // order:{total: 0, items: []},\n    resetButton: function(){\n\n        // document.querySelector(\".kUNwHA .qty\").value = 0;\n        this.state.total = 0;\n        this.state.count = 0;\n        // this.state.product = { variations: [] };\n        // this.refreshButton();\n    },\n    refreshButton: function(){\n\n        // price | get base product price\n        this.state.product.qty = parseInt(document.querySelector(\".kUNwHA .qty\").value);\n        this.state.product.price = products['items'][this.state.index].priced == \"\" ? parseFloat(products['items'][this.state.index].price) : parseFloat(products['items'][this.state.index].priced);\n\n        // get note\n        this.state.product.note = document.querySelector(\".kUNwHA .kp-note textarea\").value;\n\n        // price | calculate upon checkbox variations\n        let cb_count = 0;\n        let checkbox_list = document.querySelectorAll(\".kUNwHA .mdialog .kp-check input[type=checkbox]\");\n        for(const cb of checkbox_list){ if(cb.checked){ cb_count++; this.state.product.price+=parseFloat(cb.dataset.price);  } } //console.log(\"CB: \" + parseFloat(cb.dataset.price));\n\n        // price | calculate upon radio variations\n        let ra_count = 0;\n        let radio_list = document.querySelectorAll(\".kUNwHA .mdialog .kp-radio input[type=radio]\");\n        for(const ra of radio_list){ if(ra.checked){ ra_count++; this.state.product.price+=parseFloat(ra.dataset.price); } } //console.log(\"RA: \" + parseFloat(ra.dataset.price)); \n\n        // price | assign to button\n        this.state.product.priceF = parseFloat((this.state.product.price*this.state.product.qty));\n        document.querySelector(\".kUNwHA .add .price\").innerHTML = priceFormat(this.state.product.priceF);\n\n        // define button state, enabled, disabled\n        let dis = false;\n        if(this.state.product.priceF==0) dis = true;\n        for(v in cart.state.product.variations){ if(cart.state.product.variations[v].allow == false) dis = true; }\n\n        // define button text\n        // console.log(cart.state.product.type);\n        document.querySelector(\".kUNwHA .kp-add .mbtn .add\").style.background = \"\";\n        if(cart.state.product.type == 'update' && this.state.product.qty > 0){ document.querySelector(\".kUNwHA .kp-add .mbtn .cta\").innerHTML = \"Update\"; }\n        if(cart.state.product.type == 'update' && this.state.product.qty == 0){ document.querySelector(\".kUNwHA .kp-add .mbtn .cta\").innerHTML = \"Remove\"; document.querySelector(\".kUNwHA .kp-add .btn .add\").style.background=\"#df1960\"; dis = false; }\n        if(cart.state.product.type == 'new'){ document.querySelector(\".kUNwHA .kp-add .mbtn .cta\").innerHTML = \"Add\"; }\n\n        // refresh UI\n        if(dis){ document.querySelector(\".kUNwHA .kp-add .mbtn\").classList.add(\"dis\"); }else{ document.querySelector(\".kUNwHA .kp-add .mbtn\").classList.remove(\"dis\"); }\n    },\n    refreshCheckoutButton: function(){\n\n        // console.log(this.state.order.items);\n        let total = 0;\n        for(let p in this.state.order.items){\n\n            // console.log(this.state.order.items[p].priceF);\n            total += parseFloat(this.state.order.items[p].priceF);\n        }\n\n        this.state.order.total = total;\n\n        // trigger visibility\n        if(total>0) {\n\n            document.querySelector(\"body\").classList.add(\"cbtn\");\n            \n            setBtnStep(1);\n\n            document.querySelector(\".kUNwHA .cta-btn .price\").innerHTML = priceFormat(total);\n        }else{\n            document.querySelector(\".kUNwHA .cta-btn\").style.display = \"none\";\n            document.querySelector(\"body\").classList.remove(\"cbtn\");\n        }\n    },\n    addToCart: function(){\n\n        // sync UI with data\n        // this.refreshButton();\n\n        // add to cart\n        this.state.order.items[this.state.product.id] = this.state.product; // push(this.state.product);\n\n        console.log(this.state.order.items);\n\n        // remove from cart\n        if(this.state.product.qty==0){ this.removeFromCart(this.state.product.id); }else{ document.querySelector(\".kUNwHA .kenzap-row[data-id='\"+this.state.product.id+\"'] .ctag\").innerHTML = this.state.product.qty; }\n\n        // cache results\n        localStorage.cart = JSON.stringify(this.state.order);\n\n        // setBtnStep(1);\n        cart.refreshCheckoutButton();\n        \n    },\n    removeFromCart: function(id){\n\n        delete this.state.order.items[id];\n\n        document.querySelector(\".kUNwHA .kenzap-row[data-id='\"+id+\"'] .ctag\").innerHTML = \"\";\n \n        // cache results\n        localStorage.cart = JSON.stringify(this.state.order);\n    },\n    clearCart: function(){\n\n        // clear cart and refresh UI\n        for(let i in cart.state.order.items){  document.querySelector(\".kUNwHA .kenzap-row[data-id='\"+cart.state.order.items[i].id+\"'] .ctag\").innerHTML = \"\"; }\n\n        // reset cached data\n        cart.state.order = {};\n        cart.state.order.created = Math.floor(Date.now() / 1000);\n        cart.state.order.items = {};\n\n        localStorage.cart = JSON.stringify(cart.state.order);\n\n        // refresh cart button \n        this.refreshCheckoutButton();\n\n        // remove checkoout request from url\n        window.history.replaceState({}, document.title, config.domain);\n    }\n}"],"names":["setCookie","name","value","days","expires","date","Date","setTime","getTime","toUTCString","document","cookie","escape","getCookie","cname","decodedCookie","decodeURIComponent","ca","split","i","length","c","charAt","substring","indexOf","products","scroll","state","last_state","state_prev","fp","el_id","direction","offsets","timer","table","CDN","appID","addEventListener","setTable","initCart","getMenu","cb","console","log","authUser","scrollEvents","urlParams","URLSearchParams","window","location","search","get","toast","msg","t","querySelector","innerHTML","classList","add","setTimeout","className","replace","setBtnStep","order","localStorage","cart","created","Math","floor","now","JSON","parse","items","e","idd","randomString","refreshCheckoutButton","btnListeners","refreshDialogView","step","viewCheckoutModal","html","focus","note","alert","stringify","mdialogCnt","style","display","closeModal","origin","config","domain","href","encodeURIComponent","limit","offset","fetch","method","headers","API_KEY","body","query","type","key","fields","sortby","field","settings","then","response","json","success","sid","renderMenu","dialogListeners","menuListeners","sliderListeners","error","rows","categories","html_slider","html_menu","title","val","cat","trim","convertToSlug","x","id","_id","includes","img","imgl","Image","onload","src","setAttribute","price","priceFormat","ctag","qty","show_heading","slider_container","menu_container","close","close2","cdialogCnt","height","overflowY","remove","documentElement","scrollTop","contains","screen","availHeight","row_list","querySelectorAll","row","dataset","index","product_id","total","count","product","sdesc","variations","html_vars","v","required","allow","d","data","checked","list","refreshButton","checkbox_list","parseInt","indexv","cbg","parseFloat","radio_list","rag","plus","max_addition","vibrate","minus","parentNode","addToCart","p","priceF","td","confirm","removeFromCart","Object","keys","viewThankyouModal","tdialogCnt","lastOrder","force","ott","params","append","checkout","token","kid","from","status","ajaxCheckout","clearCart","navigator","slide_list","slide","scrollDiv","offsetLeft","sto","el","l","h_list","diff_prev","diff","h","offsetTop","sc","clearTimeout","scrollTo","left","behavior","str","toLowerCase","toFixed","symbol","length_","chars","random","resetButton","priced","cb_count","ra_count","ra","dis","background","history","replaceState"],"mappings":"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"}